<!DOCTYPE HTML>
<?xml version="1.0" encoding="utf-8"?><html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<meta charset="utf-8">
		<meta name="keywords" content="">
		<meta name="Author" content="Basil Peace">
		<meta name="Copyright" content="Copyright © 2014  Basil Peace">
		<meta name="Robots" content="INDEX FOLLOW">
		<title>Архитектура — FIDATA</title>
		<link rel="stylesheet" href="../css/webfonts.css">
		<link rel="stylesheet" href="../css/stylesheet.css">
		<script type="text/javascript" src="//code.jquery.com/jquery-1.11.1.min.js"></script>
		<script type="text/javascript" src="../scripts/tools.js"></script>
		<script type="text/javascript" src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
		<meta name="generator" content="nanoc 3.6.11">
	</head>
	<body>
		<div id="header">
	<div id="logo">
		<a href="http://fidata.org/" title="FIDATA"><img src="../images/logo.png" alt="FIDATA Logo" title="FIDATA Logo"></a>
	</div>
	<div id="headerImg">
		
		<div id="websiteNameDiv">
			<h1 id="websiteName">FIDATA</h1>
			<div id="websiteSubtitle">Свободная платформа для анализа финансовых и нефинансовых данных, разработки торговых систем и роботов, для любых рынков и инструментов</div>
		</div>
		
	</div>
</div>
		<div id="main2">
			<table cellspacing="6" id="main"><tbody><tr>
			
<td class="column">
	<table class="Block" cellspacing="0">
		<thead><tr><td class="BlockTitle">» Содержание сайта</td></tr></thead>
		<tbody><tr><td class="BlockContents"><div id="content">
	<div class="menuItem">
	
		<a href="index.html">Главная</a>
	
</div>
<div class="menuItem">
	
		<a href="trading.html">Трейдинг</a>
	
</div>
<div class="menuItem">
	
		<a href="requirements.html">Требования к хорошему ПО для трейдинга</a>
	
</div>
<div class="menuItem">
	
		<a href="../en/existing_products.html" lang="en">Existing products</a>
	
</div>
<div class="menuItem">
	
		<a href="DSL.html">Языки для разработки роботов и ТС</a>
	
</div>
<div class="menuItem">
	
		<a href="existing_problems.html">Существующие проблемы</a>
	
</div>
<div class="menuItem">
	
		<a href="features.html">Возможности</a>
	
</div>
<div class="menuItem">
	
		<span>Архитектура</span>
	
</div>
<div class="menuItem">
	
		<a href="reusable_code.html">Переиспользуемый код</a>
	
</div>
<div class="menuItem">
	
		<a href="implementation_plan.html">План реализации</a>
	
</div>
<div class="menuItem">
	
		<a href="licensing.html">Лицензирование</a>
	
</div>
<div class="menuItem">
	
		<a href="development_and_building.html">Разработка и сборка</a>
	
</div>
<div class="menuItem">
	
		<a href="monetization.html">Монетизация</a>
	
</div>
<div class="menuItem">
	
		<a href="name.html">О названии</a>
	
</div>
<div class="menuItem">
	
		<a href="FAQ.html">FAQ</a>
	
</div>
<div class="menuItem">
	
		<a href="contacts.html">Контакты</a>
	
</div>

</div></td></tr></tbody>
	</table>
	<table class="Block" cellspacing="0">
		<thead><tr><td class="BlockTitle">» Переводы</td></tr></thead>
		<tbody><tr><td class="BlockContents"><div id="translations">
	
		<div class="menuItem">
	
		<a href="../en/architecture.html" lang="en">English</a>
	
</div>
	
		<div class="menuItem">
	
		<span>Русский</span>
	
</div>
	
</div></td></tr></tbody>
	</table>
</td>
			
			<td id="body">
				
					
				
				
				<h1 id="section">Архитектура</h1>

<h2 id="section-1">Модульность</h2>

<p>Платформа будет иметь модульную архитектуру. Под модулем я понимаю
набор исполняемых и вспомогательных файлов, доставляемых на компьютер
пользователя. Для развёртывания модулей я планирую использовать
<a href="http://doc-snapshot.qt-project.org/qtifw-master/index.html">Qt Installer Framework</a>.
С точки зрения разработчика модуль может включать как один, так и
несколько артефактов.</p>

<p>В платформу будет встроен движок, подобный OSGi. Он позволит описать
стандартные интерфейсы, которые должны предоставлять модули, и
динамически загружать конкретную реализацию. Примеры того, что может
работать через стандартные интерфейсы:</p>

<ul>
  <li><a href="DSL.html">языки программирования для разработки роботов/ТС</a></li>
  <li>протоколы для работы с поставщиками данных и организаторами торгов</li>
  <li>форматы импорта/экспорта данных</li>
  <li>виды графиков</li>
  <li>индикаторы ТА</li>
  <li>численные алгоритмы</li>
  <li>локализация пользовательского интерфейса</li>
</ul>

<p>Преимущества модульной архитектуры:</p>

<ul>
  <li>
    <p><strong>Для пользователей</strong>:</p>

    <ul>
      <li>
        <p>удобство установки и обновления</p>

        <p>Пользователь устанавливает только необходимые ему модули, не
перегружая интерфейс и поддерживая размер установки в разумных
пределах.</p>
      </li>
      <li>
        <p>возможность использования сторонних модулей под несовместимыми
лицензиями (см.
<a href="licensing.html">Лицензирование</a>)</p>
      </li>
      <li>
        <p>удобство написания собственных модулей</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Для разработчиков</strong>:</p>

    <ul>
      <li>
        <p>удобство разработки и поддержки</p>
      </li>
      <li>
        <p>удобство выпуска обновлений</p>
      </li>
      <li>
        <p>удобство поддержки различных программных и аппаратных платформ
(выпуска платформозависимых версий модулей)</p>
      </li>
      <li>
        <p>удобство переиспользования готового кода из других проектов</p>
      </li>
      <li>
        <p>возможность иметь несколько альтернативных реализаций,
сравнивать их по производительности и выбирать лучшие решения</p>
      </li>
    </ul>
  </li>
</ul>

<h2 id="section-2">Клиент-серверная архитектура</h2>

<p>Платформа будет иметь клиент-серверную архитектуру.</p>

<p><img src="images/architecture.png" alt="Архитектура"></p>

<p>С программной точки зрения это будет трёх/четырёхзвенная архитектура.</p>

<p>С аппаратной точки зрения это будет, скорее всего, двухзвенная
архитектура. Если вычисления будут выполняться внутри сервера
приложений, тогда, по моему мнению, будет неэффективно запускать СУБД и
сервер приложений на отдельных компьютерах, так как это потребовало бы
передачи больших объёмов данных по сети. Так же это могло бы потребовать
организации дополнительного временного хранилища внутри сервера
приложений. Подробнее см. ниже.</p>

<h2 id="section-3">Конкретные задачи, реализуемые на разных уровнях архитектуры</h2>

<ol>
  <li>
    <p><strong>СУБД</strong>:</p>

    <ul>
      <li>
        <p>Хранение данных</p>

        <ul>
          <li>Хранение временных рядов</li>
          <li>Хранение метаданных</li>
          <li>Хранение данных, получаемых при тестировании ТС</li>
          <li>Поддержание целостности данных</li>
        </ul>
      </li>
      <li>
        <p>(Возможно) Выполнение вычислений (анализ данных)</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Сервер приложений</strong>:</p>

    <ul>
      <li>
        <p>Взаимодействие с клиентами</p>

        <ul>
          <li>Авторизация пользователей</li>
          <li>Получение команд</li>
          <li>Передача результатов вычислений</li>
          <li>Трансляция объектов метаданных</li>
        </ul>
      </li>
      <li>
        <p>Взаимодействие c СУБД</p>
      </li>
      <li>
        <p>(Возможно) Выполнение вычислений (анализ данных, тестирование
ТС)</p>
      </li>
      <li>
        <p>Компиляция ТС</p>
      </li>
      <li>
        <p>Тестирование ТС</p>

        <ul>
          <li>Получение реальных данных</li>
          <li>Предоставление биржевых протоколов</li>
        </ul>
      </li>
      <li>
        <p>Генерация отчётов</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Тонкий клиент</strong>:</p>

    <ul>
      <li>
        <p>Взаимодействие с сервером</p>
      </li>
      <li>
        <p>Редактирование ТС (в форме исходного кода и в графическом виде)</p>
      </li>
      <li>
        <p>Просмотр и редактирование метаданных</p>
      </li>
      <li>
        <p>Построение графиков и графический анализ</p>

        <ul>
          <li>Получение данных от сервера</li>
          <li>Получение реальных данных</li>
        </ul>
      </li>
      <li>
        <p>Отображение результатов анализа данных и тестирования ТС</p>
      </li>
    </ul>
  </li>
  <li>
    <p><strong>Веб-приложение</strong>:</p>

    <ul>
      <li>
        <p>обычный тонкий клиент</p>
      </li>
      <li>
        <p>технология, отрисовывающая десктопные окна в веб-страницу</p>
      </li>
    </ul>
  </li>
</ol>

<h2 id="section-4">Нерешённые вопросы</h2>

<ol>
  <li>
    <p>Где следует производить вычисления?</p>

    <p>Теоретически возможно реализовать все вычисления внутри СУБД.</p>

    <p><strong>Аргументы “ЗА”</strong>:</p>

    <ol>
      <li>
        <p>СУБД сама по себе способна выполнять отдельные вычисления (к
примеру, арифметические средние, оконные функции). Поэтому есть смысл
выполнять существующие в них алгоритмы на GPU.</p>
      </li>
      <li>
        <p>СУБД с развитыми процедурными языками и возможностью подключения
библиотек на C (такая, как PostgreSQL) позволяет реализовать все
вычисления внутри СУБД.</p>
      </li>
      <li>
        <p>Если выполнять вычисления только внутри СУБД, тогда возможно
реализовать трёхзвенную аппаратную архитектуру.</p>
      </li>
    </ol>

    <p><strong>Аргументы “ПРОТИВ”</strong>:</p>

    <ol>
      <li>
        <p>Нам необходимы оба метода вычислений:</p>

        <ul>
          <li>
            <p>Вычисления на исторических данных</p>

            <p>Для ускорения работы эффективно рассчитать нужный индекс
на большом объёме данных, используя GPU.</p>
          </li>
          <li>
            <p>Вычисления на реальных данных</p>

            <p>Использовать GPU для расчёта одного числа неэффективно и
бессмысленно.</p>
          </li>
        </ul>

        <p>Реализация внутри СУБД всё ещё требует реализации того же
алгоритма в отдельной библиотеке, подгружаемой роботом.</p>
      </li>
      <li>
        <p>Реализация внутри СУБД сложнее для отладки и поиска багов.</p>
      </li>
      <li>
        <p>Пока не очень понятно, как модульная архитектура могла бы
ужиться внутри СУБД. Не понятно, как будет выполняться установка,
обновление или удаление отдельных модулей.</p>
      </li>
      <li>
        <p>У реализации вычислений внутри СУБД могут быть другие подводные
камни, о которых я пока не знаю.</p>
      </li>
    </ol>
  </li>
  <li>
    <p><a name="problem_compilation"></a><strong>Компиляция робота/ТС</strong></p>

    <p>Возможность компиляции означает, что платформа должна иметь
встроенный компилятор. Компилятор должен быть совместимым с тем, который
<a href="development_and_building.html#C_CPP_compiler">использовался для компиляции платформы и библиотек</a>.
Для С/С++ или языка на их основе мы не можем и не будем встраивать в
платформу MSVC. Однако, это нарушает
<a href="requirements.html#work_out_of_the_box">требование работы «из коробки»</a>.</p>

    <p><strong>Варианты решения</strong>:</p>

    <ul>
      <li>
        <p>Отказаться от компиляции в пользу интерпретации.</p>
      </li>
      <li>
        <p>Интерпретировать код на платформе и сделать возможность
генерации текста на C/C++ или в каком-то промежуточном формате для
самостоятельной компиляции в бинарники пользователем.</p>
      </li>
      <li>
        <p>Не включать в поставку никаких компиляторов. Использовать
компилятор, найденный на машине пользователя. (Не удовлетворяет
требованию работы «из коробки»).</p>
      </li>
      <li>
        <p>Использовать для написания роботов не-С/С++ язык (например,
Pascal).</p>
      </li>
    </ul>

    <p><strong>Рассматриваемое решение</strong>: требовать от пользователей Windows
установленную Visual Studio. Express-версия бесплатна и может быть
установлена пользователем самостоятельно. Поскольку:</p>

    <ul>
      <li>мы разрабатываем свободное ПО,</li>
      <li>необходимо поощрять пользователей Windows переходить на
свободные платформы,</li>
      <li>даже пользователи Windows будут часто запускать роботов на
серверах под управлением GNU/Linux, и возможности компиляции под Windows
будут ещё менее востребованы,</li>
      <li>других возможностей (помимо выбора другого языка), видимо, не
существует,</li>
    </ul>

    <p>то возможно сделать некоторые ограничения для ярых поклонников
Windows.</p>
  </li>
  <li>
    <p><a name="problem_online_data"></a><strong>Архитектура подсистемы
получения онлайн-данных</strong></p>

    <ol>
      <li>Как будут получаться данные клиентом (через сервер или напрямую
от биржи)?</li>
      <li>Как данные будут записываться в базу данных на сервере?</li>
      <li>Как данные будут распределяться на сервере между базой данных и
тестируемыми в данный момент ТС?</li>
      <li>Как будут вычисляться индикаторы в реальном времени?</li>
    </ol>

    <p>Возможно, здесь нужен какой-то кэш или перераспределитель данных.
См. как это сделано в kdb+:
<a href="http://kx.com/_papers/Kx_White_Paper-2013-131023.pdf">http://kx.com/_papers/Kx_White_Paper-2013-131023.pdf</a>.</p>
  </li>
</ol>

				
					<div id="disqus_thread"></div>
					<script type="text/javascript">        var disqus_shortname = 'fidata';
var disqus_identifier = '/ru/architecture';
var disqus_title = 'Архитектура';

        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
</script>
					<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
				
			</td>
			
<td class="column">
	<table class="Block" cellspacing="0">
		<thead><tr><td class="BlockTitle">» Twitter</td></tr></thead>
		<tbody><tr><td class="BlockContents">
<a class="twitter-timeline" href="https://twitter.com/fidata_team" data-widget-id="460120771394670592">Твиты пользователя @fidata_team</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</td></tr></tbody>
	</table>

</td>
			</tr></tbody></table>
		</div>
		<div id="footer"><div>
	
		Содержимое данной страницы: Copyright © 2014  Basil Peace.
	
	<a href="../en/license.html">Условия использования</a>.
	Дизайн: Copyright © 2014  Basil Peace
</div></div>
		<script>
		  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
		  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
		  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
		  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

		  ga('create', 'UA-51510993-1', 'fidata.org');
		  ga('send', 'pageview');

		</script>
	</body>
</html>
